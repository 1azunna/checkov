metadata:
  name: "lookup"
  category: "GENERAL_SECURITY"
  scope:
  provider: "aws"
  id: "CKV2_AWS_2509"
definition:
  or:
    - cond_type: "attribute"
      resource_types:
        - "aws_sns_topic_subscription"
      attribute: "protocol"
      operator: "not_equals"
      value: "http"
    - cond_type: "attribute"
      resource_types:
        - "AWS::SNS::Subscription"
      attribute: "Protocol"
      operator: "not_equals"
      value: "http"
    - cond_type: "attribute"
      resource_types:
        - "AWS::SNS::Topic"
      attribute: "Subscription.Protocol"
      operator: "not_equals"
      value: "http"