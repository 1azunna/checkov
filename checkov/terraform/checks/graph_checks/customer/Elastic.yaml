---
metadata:
 name: "Elastic Testing"
 category: "general"
 id: "elastic"
 guidelines: "testing"
 severity: "high"
scope:
  provider: "aws"
definition:
  and:
    - or:
        - cond_type: "attribute"
          resource_types:
          - "aws_elasticsearch_domain"
          attribute: "cognito_options.enabled"
          operator: "equals"
          value: "true"
        - or:
            - cond_type: "attribute"
              resource_types:
                - "aws_elasticsearch_domain_saml_options"
              attribute: "saml_options.enabled"
              operator: "equals"
              value: "true"
            - cond_type: "attribute"
              resource_types:
                - "aws_elasticsearch_domain_saml_options"
              attribute: "saml_options.enabled"
              operator: "not_exists"
    - cond_type: "connection"
      resource_types:
        - "aws_elasticsearch_domain"
      connected_resource_types:
        - "aws_elasticsearch_domain_saml_options"
      operator: "exists"
    - cond_type: "filter"
      attribute: "resource_type"
      operator: "within"
      value: "aws_elasticsearch_domain"